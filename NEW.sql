CREATE DATABASE DATE;
USE DATE;
CREATE TABLE COUNTRY(ID INT PRIMARY KEY AUTO_INCREMENT,
COUNTRY_NAME VARCHAR(30),
POPULATION INT,
AREA INT);

CREATE TABLE PERSONS (ID INT PRIMARY KEY AUTO_INCREMENT,
FIRST_NAME VARCHAR(30),
LAST_NAME VARCHAR(30),
POPULATION INT NOT NULL,
RATING DECIMAL(3,1)NOT NULL,
COUNTRY_ID INT NOT NULL,
COUNTRY_NAME VARCHAR(30));

INSERT INTO COUNTRY(COUNTRY_NAME,POPULATION,AREA) VALUES
('INDIA',1366000000,23478000),
('USA',196000000,2348000),
('CHINA',336000000,533578000),
('ENGLAND',106000000,9978000),
('PAKISTAN',18000000,12478000),
('SRILANKA',66000000,5638000),
('BANGLADESH',56000000,65378000),
('BRAZIL',266000000,75378000),
('CANADA',166000000,2128000),
('ARGENTINA',766000000,1278000);
SELECT * FROM COUNTRY;
INSERT INTO PERSONS(FIRST_NAME,LAST_NAME,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)VALUES
('ABHINAV','A',2500000,4.5,1,'USA'),
('ARUN','AK',1500000,3.5,2,'CANADA'),
('AKSHAY','KUMAR',2500000,4.5,3,'INDIA'),
('ANANYA','C',22500000,3.5,4,'BRAZIL'),
('APARNA','A',900000,2.5,5,'ARGENTINA'),
('JIBIN','KK',210000,4.7,6,'PORTUGAL'),
('KARUN','H',3500000,4.8,9,'BANGLADESH'),
('ADERSH','R',1500000,3.9,7,'PAKISTAN'),
('ANANDU','E',7500000,4.0,8,'ITALY'),
('HISHAM','P',3500000,4.2,1,'USA');
SELECT * FROM PERSONS;
SELECT PERSONS.FIRST_NAME,PERSONS.LAST_NAME,COUNTRY.COUNTRY_NAME FROM PERSONS
INNER JOIN COUNTRY ON PERSONS.COUNTRY_ID='COUNTRY.ID';
SELECT PERSONS.FIRST_NAME,PERSONS.LAST_NAME,COUNTRY.COUNTRY_NAME FROM PERSONS
LEFT JOIN COUNTRY ON PERSONS.COUNTRY_ID='COUNTRY_ID';
SELECT PERSONS.FIRST_NAME,PERSONS.LAST_NAME,COUNTRY.COUNTRY_NAME FROM PERSONS
RIGHT JOIN COUNTRY ON PERSONS.COUNTRY_ID ='COUNTRY_ID';
SELECT SUBSTRING(COUNTRY_NAME,1,2) AS COUNTRY_SHORTNAME FROM COUNTRY;
SELECT CONCAT(FIRST_NAME,' ',LAST_NAME) AS FULL_NAME FROM PERSONS;
SELECT COUNT(DISTINCT COUNTRY_NAME) AS UNIQUE_COUNTRIES FROM PERSONS;
SELECT MAX(POPULATION) AS MAX_POPULATION FROM COUNTRY;
SELECT MIN(POPULATION) AS MIN_POPULATION FROM COUNTRY;

ALTER TABLE PERSONS ADD COLUMN DOB DATE;
UPDATE PERSONS SET DOB = '2001-05-23' WHERE ID = 1;
UPDATE PERSONS SET DOB = '1993-01-21' WHERE ID = 2;
UPDATE PERSONS SET DOB = '1999-02-11' WHERE ID = 3;
UPDATE PERSONS SET DOB = '1998-11-09' WHERE ID = 4;
UPDATE PERSONS SET DOB = '1994-02-07' WHERE ID = 5;
UPDATE PERSONS SET DOB = '1992-07-05' WHERE ID = 6;
UPDATE PERSONS SET DOB = '1996-09-02' WHERE ID = 7;
UPDATE PERSONS SET DOB = '1995-05-27' WHERE ID = 8;
UPDATE PERSONS SET DOB = '1989-01-13' WHERE ID = 9;
UPDATE PERSONS SET DOB = '1990-08-10' WHERE ID = 10;
SELECT * FROM PERSONS;

DELIMITER $$
CREATE FUNCTION FUN_CAL_AGE(AGE DATE)
RETURNS INT
deterministic
BEGIN DECLARE TODAYDATE DATE;
SELECT CURRENT_DATE() INTO TODAYDATE;
RETURN YEAR(TODAYDATE)=YEAR(AGE);
END$$
DELIMITER ;

SELECT ID,FIRST_NAME,LAST_NAME,FUN_CAL_AGE(DOB) AS AGE
FROM PERSONS;

INSERT INTO PERSONS(ID,FIRST_NAME,DOB,POPULATION,RATING,COUNTRY_ID,COUNTRY_NAME)VALUES
(11,'AJU','1998-03-21','2000000',4.4,2,'USA'),
(12,'ASWIN','1998-03-08','3000000',4.4,3,'USA');
SELECT *FROM PERSONS;

SELECT COUNT(LAST_NAME) FROM PERSONS;

SELECT COUNT(*) AS NUM_OF_ROWS FROM PERSONS;

SELECT NOW();

SELECT POPULATION FROM COUNTRY LIMIT 3;

SELECT * FROM COUNTRY ORDER BY RAND() LIMIT 3;




 